<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Munet ESP network library for muwerk scheduler: ustd::Net Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Munet ESP network library for muwerk scheduler
   </div>
   <div id="projectbrief">A muwerk network library for WLAN, NTP, OTA and MQTT support for ESP8266 and ESP32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceustd.html">ustd</a></li><li class="navelem"><a class="el" href="classustd_1_1Net.html">Net</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classustd_1_1Net-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ustd::Net Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Munet, the muwerk network class for WLAN and NTP.  
 <a href="classustd_1_1Net.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="net_8h_source.html">net.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a4494dd2ae48ff42082708cbc75e56ca9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Net.html#a4494dd2ae48ff42082708cbc75e56ca9">Netstate</a> { <a class="el" href="classustd_1_1Net.html#a4494dd2ae48ff42082708cbc75e56ca9a9664c0befc981d1dee772f6987d3b85e">NOTDEFINED</a>, 
<a class="el" href="classustd_1_1Net.html#a4494dd2ae48ff42082708cbc75e56ca9a92106b569cd1c659078b11189881fcf6">NOTCONFIGURED</a>, 
<a class="el" href="classustd_1_1Net.html#a4494dd2ae48ff42082708cbc75e56ca9a9fe5afdf4ef1ff9613ad4f8d67fccde7">CONNECTINGAP</a>, 
<a class="el" href="classustd_1_1Net.html#a4494dd2ae48ff42082708cbc75e56ca9a143ec2c42ab1813ed559a5ea0bc8b133">CONNECTED</a>
 }</td></tr>
<tr class="separator:a4494dd2ae48ff42082708cbc75e56ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf779baf5524454de435b60e8ded369c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369c">Netmode</a> { <a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369caaccc429c88b5b0fbd13486da331ad120">AP</a>, 
<a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369cad50e6ef7347c61cca6cb696175303a89">STATION</a>
 }</td></tr>
<tr class="separator:acf779baf5524454de435b60e8ded369c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9506090d3b6ba2969144eee25ac40c5a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Net.html#a9506090d3b6ba2969144eee25ac40c5a">Net</a> (uint8_t signalLed=0xff)</td></tr>
<tr class="separator:a9506090d3b6ba2969144eee25ac40c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e41f33f0e8a159e639c5940e84aff9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Net.html#a26e41f33f0e8a159e639c5940e84aff9">configureNTP</a> ()</td></tr>
<tr class="separator:a26e41f33f0e8a159e639c5940e84aff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f2e7160c088d480d811bc52bee5f6c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Net.html#a3f2e7160c088d480d811bc52bee5f6c1">begin</a> (Scheduler *_pSched, bool _restartEspOnRepeatedFailure=true, String _ssid=&quot;&quot;, String _password=&quot;&quot;, <a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369c">Netmode</a> _mode=<a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369caaccc429c88b5b0fbd13486da331ad120">AP</a>)</td></tr>
<tr class="separator:a3f2e7160c088d480d811bc52bee5f6c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Munet, the muwerk network class for WLAN and NTP. </p>
<p>The library header-only and relies on the libraries ustd, muwerk, Arduino_JSON, and PubSubClient.</p>
<p>Make sure to provide the <a href="https://github.com/muwerk/ustd/blob/master/README.md">required platform define</a> before including ustd headers.</p>
<p>See <a href="https://github.com/muwerk/munet/blob/master/README.md">for network credential and NTP configuration.</a></p>
<p>Alternatively, credentials can be given in source code during <a class="el" href="classustd_1_1Net.html#a3f2e7160c088d480d811bc52bee5f6c1">Net.begin()</a>. (s.b.)</p>
<h2>Sample network connection</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#define __ESP__ 1   // Platform defines required, see doc, mainpage.</span></div>
<div class="line"><span class="preprocessor">#include &quot;scheduler.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="net_8h.html">net.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ota_8h.html">ota.h</a>&quot;</span>  <span class="comment">// optional for over-the-air software updates</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="mqtt_8h.html">mqtt.h</a>&quot;</span> <span class="comment">// optional for connection to external MQTT server</span></div>
<div class="line"> </div>
<div class="line">ustd::Scheduler sched;</div>
<div class="line"><a class="code" href="classustd_1_1Net.html">ustd::Net</a> net(LED_BUILTIN);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classustd_1_1Ota.html">ustd::Ota</a> ota();  <span class="comment">// optional</span></div>
<div class="line"><a class="code" href="classustd_1_1Mqtt.html">ustd::Mqtt</a> mqtt();<span class="comment">// optional</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> appLoop();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">    pinMode(LED_BUILTIN, OUTPUT);</div>
<div class="line">    net.begin(&amp;sched);  <span class="comment">// connect to WLAN and sync NTP time,</span></div>
<div class="line">                        <span class="comment">// credentials read from SPIFFS, (net.json)</span></div>
<div class="line">    ota.begin(&amp;sched);  <span class="comment">// optional ota update</span></div>
<div class="line">    mqtt.<a class="code" href="classustd_1_1Mqtt.html#a877c8cf4c93fb0bc0a849316304c1967">begin</a>(&amp;sched); <span class="comment">// optional connection to external MQTT server</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> tID = sched.add(appLoop, <span class="stringliteral">&quot;main&quot;</span>);  <span class="comment">// create task for your app code</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> appLoop() {</div>
<div class="line">    <span class="comment">// your code goes here.</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Never add code to this loop, use appLoop() instead.</span></div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">    sched.loop();</div>
<div class="line">}</div>
</div><!-- fragment --> </div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="acf779baf5524454de435b60e8ded369c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf779baf5524454de435b60e8ded369c">&#9670;&nbsp;</a></span>Netmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369c">ustd::Net::Netmode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="acf779baf5524454de435b60e8ded369caaccc429c88b5b0fbd13486da331ad120"></a>AP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="acf779baf5524454de435b60e8ded369cad50e6ef7347c61cca6cb696175303a89"></a>STATION&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<a id="a4494dd2ae48ff42082708cbc75e56ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4494dd2ae48ff42082708cbc75e56ca9">&#9670;&nbsp;</a></span>Netstate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classustd_1_1Net.html#a4494dd2ae48ff42082708cbc75e56ca9">ustd::Net::Netstate</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4494dd2ae48ff42082708cbc75e56ca9a9664c0befc981d1dee772f6987d3b85e"></a>NOTDEFINED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4494dd2ae48ff42082708cbc75e56ca9a92106b569cd1c659078b11189881fcf6"></a>NOTCONFIGURED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4494dd2ae48ff42082708cbc75e56ca9a9fe5afdf4ef1ff9613ad4f8d67fccde7"></a>CONNECTINGAP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4494dd2ae48ff42082708cbc75e56ca9a143ec2c42ab1813ed559a5ea0bc8b133"></a>CONNECTED&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9506090d3b6ba2969144eee25ac40c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9506090d3b6ba2969144eee25ac40c5a">&#9670;&nbsp;</a></span>Net()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ustd::Net::Net </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>signalLed</em> = <code>0xff</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Instantiate a network object for WLAN and NTP connectivity.</p>
<p>The <a class="el" href="classustd_1_1Net.html" title="Munet, the muwerk network class for WLAN and NTP.">Net</a> object publishes messages using muwerk's pub/sub intertask communication (which does not rely on MQTT servers), other muwerk tasks can subscribe to the following topics:</p>
<p>subscribe('net/network'); for information about wlan connection state changes. Status can be actively requested by publish('net/network/get');</p>
<p>subscribe('net/rssi'); for information about WLAN reception strength</p>
<p>subscribe('net/services'); for a list of available network services.</p>
<p>subscribe('net/networks'); for a list of WLANs nearby.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">signalLed</td><td>(optional), Pin that will be set to LOW (led on) during network connection attempts. Once connected, led is switched off and can be used for other functions. Led on signals that the ESP is trying to connect to a network.</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3f2e7160c088d480d811bc52bee5f6c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f2e7160c088d480d811bc52bee5f6c1">&#9670;&nbsp;</a></span>begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ustd::Net::begin </td>
          <td>(</td>
          <td class="paramtype">Scheduler *&#160;</td>
          <td class="paramname"><em>_pSched</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_restartEspOnRepeatedFailure</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>_ssid</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>_password</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369c">Netmode</a>&#160;</td>
          <td class="paramname"><em>_mode</em> = <code><a class="el" href="classustd_1_1Net.html#acf779baf5524454de435b60e8ded369caaccc429c88b5b0fbd13486da331ad120">AP</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Connect to WLAN network and request NTP time</p>
<p>This function starts the connection to a WLAN network, by default using the network credentials configured in net.json. Once a connection is established, a NTP time server is contacted and time is set according to local timezone rules as configured in net.json.</p>
<p>Note: NTP configuration is only available via net.json, ssid and password can also be set using this function.</p>
<p>Other muwerk task can subscribe to topic 'net/network' to receive information about network connection states.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_pSched</td><td>Pointer to the muwerk scheduler. </td></tr>
    <tr><td class="paramname">_restartEspOnRepeatedFailure</td><td>(optional, default true) restarts ESP on continued failure. </td></tr>
    <tr><td class="paramname">_ssid</td><td>(optional, default unused) Alternative way to specify WLAN SSID not using net.json. </td></tr>
    <tr><td class="paramname">_password</td><td>(optional, default unused) Alternative way to specify WLAN password. </td></tr>
    <tr><td class="paramname">_mode</td><td>(optional, default AP) Currently unused network mode.</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a26e41f33f0e8a159e639c5940e84aff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26e41f33f0e8a159e639c5940e84aff9">&#9670;&nbsp;</a></span>configureNTP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ustd::Net::configureNTP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="net_8h_source.html">net.h</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aota_8h_html"><div class="ttname"><a href="ota_8h.html">ota.h</a></div></div>
<div class="ttc" id="aclassustd_1_1Mqtt_html"><div class="ttname"><a href="classustd_1_1Mqtt.html">ustd::Mqtt</a></div><div class="ttdef"><b>Definition:</b> mqtt.h:19</div></div>
<div class="ttc" id="aclassustd_1_1Ota_html"><div class="ttname"><a href="classustd_1_1Ota.html">ustd::Ota</a></div><div class="ttdef"><b>Definition:</b> ota.h:20</div></div>
<div class="ttc" id="aclassustd_1_1Net_html"><div class="ttname"><a href="classustd_1_1Net.html">ustd::Net</a></div><div class="ttdoc">Munet, the muwerk network class for WLAN and NTP.</div><div class="ttdef"><b>Definition:</b> net.h:103</div></div>
<div class="ttc" id="anet_8h_html"><div class="ttname"><a href="net_8h.html">net.h</a></div></div>
<div class="ttc" id="aclassustd_1_1Mqtt_html_a877c8cf4c93fb0bc0a849316304c1967"><div class="ttname"><a href="classustd_1_1Mqtt.html#a877c8cf4c93fb0bc0a849316304c1967">ustd::Mqtt::begin</a></div><div class="ttdeci">void begin(Scheduler *_pSched, String _clientName=&quot;&quot;, String _domainToken=&quot;&quot;, String _outDomainToken=&quot;omu&quot;)</div><div class="ttdef"><b>Definition:</b> mqtt.h:113</div></div>
<div class="ttc" id="amqtt_8h_html"><div class="ttname"><a href="mqtt_8h.html">mqtt.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
